<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Heatmaps</title>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      #panel {
        position: absolute;
        top: 5px;
        left: 50%;
        margin-left: -180px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
      }
    </style>
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=visualization"></script>
    <script src="pincode.js" type="text/javascript"></script>
    <!-- <script src="test.js" type="text/javascript"></script> -->
 
    <script>
// Adding 500 Data Points
var map, pointarray, heatmap;
var geocoder;
var data2;
function initialize2() {
	//data2 = getData();
	
	
	
	
	  geocoder = new google.maps.Geocoder();
	//  var latlng = new google.maps.LatLng(-34.397, 150.644);
	
	}
var coordinates=[];
/*
var millisecondsToWait = 50;
setTimeout(function() {
    // Whatever you want to do after the wait
}, millisecondsToWait);
*/
var data=[];
function codeAddress() {
	//console.log(dataPin);
	  var address ="400072";
	  
	  var e = d
	  
	  
	 // data = convertcsv;
	  var counter = 0;
	  for(var c = 0; c<dataPin.length;c++){
		  address = dataPin[c];
		//  console.log(d[0]);
		  
		  
		  place = getCoordinatesByPincode(dataPin[c]);
		 if(place!=undefined){ 
		  coordinates[counter]=new google.maps.LatLng(place.lat, place.lng);
counter++;


}		  
		  /*

		  geocoder.geocode( { 'address': address}, function(results, status) {
			    if (status == google.maps.GeocoderStatus.OK) {
			    	counter++;
			      map.setCenter(results[0].geometry.location);
			   
			      
			      
			      coordinates[counter]=new google.maps.LatLng(results[0].geometry.location.lat(), results[0].geometry.location.lng());
			      console.log(coordinates);
			      //alert(results[0]);
			      
			    } else {
			      alert('Geocode was not successful for the following reason: ' + status);
			    }
			  });
		  */
		  
		  
		  //coordinates[c]=dataPin.
	  
	  
	 // console.log(coordinates);
	  }
	  console.log(coordinates);
	  /*
	  geocoder.geocode( { 'address': address}, function(results, status) {
	    if (status == google.maps.GeocoderStatus.OK) {
	      map.setCenter(results[0].geometry.location);
	      console.log(results[0]);
	      /*
	      var marker = new google.maps.Marker({
	          map: map,
	          position: results[0].geometry.location
	      });
	      */
	      /*
	      alert(results[0]);
	      
	    } else {
	      alert('Geocode was not successful for the following reason: ' + status);
	    }
	  });
	  */
	}

	
var taxiData = [
  new google.maps.LatLng(37.782551, -122.445368),
  new google.maps.LatLng(37.782745, -122.444586)
  
];

$(document).ready(
		initialize());

function initialize() {
	setInterval(getCodeAddress(),300);
	initialize2();
/*
	
	codeAddress();
  var mapOptions = {
    zoom: 13,
    center: new google.maps.LatLng(37.774546, -122.433523),
    mapTypeId: google.maps.MapTypeId.SATELLITE
  };

  map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);

  var pointArray = new google.maps.MVCArray(coordinates);

  heatmap = new google.maps.visualization.HeatmapLayer({
    data: pointArray
  });

  heatmap.setMap(map);
  */
}


function getCoordinatesByPincode(key){
	//console.log(data2[10].pin);
	for(var c = 0;c<data2.length;c++){
		if(data2[c].pin==key){
			return data2[c];
		}
	}
	
}
function toggleHeatmap() {
  heatmap.setMap(heatmap.getMap() ? null : map);
}

function changeGradient() {
  var gradient = [
    'rgba(0, 255, 255, 0)',
    'rgba(0, 255, 255, 1)',
    'rgba(0, 191, 255, 1)',
    'rgba(0, 127, 255, 1)',
    'rgba(0, 63, 255, 1)',
    'rgba(0, 0, 255, 1)',
    'rgba(0, 0, 223, 1)',
    'rgba(0, 0, 191, 1)',
    'rgba(0, 0, 159, 1)',
    'rgba(0, 0, 127, 1)',
    'rgba(63, 0, 91, 1)',
    'rgba(127, 0, 63, 1)',
    'rgba(191, 0, 31, 1)',
    'rgba(255, 0, 0, 1)'
  ]
  heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
}

function changeRadius() {
  heatmap.set('radius', heatmap.get('radius') ? null : 20);
}

function changeOpacity() {
  heatmap.set('opacity', heatmap.get('opacity') ? null : 0.2);
}

google.maps.event.addDomListener(window, 'load', initialize);


 var p12 = 400001;
 data3 = [];
 counter3 = 0;

function getCodeAddress() {
	
	 geocoder = new google.maps.Geocoder();
  var address = p12+"";
  
  geocoder.geocode( { 'address': address}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
          return results[0].geometry.location
data3[counter3].pincode=results[0].address_components[0].long_name;
data3[counter3].lat= results[0].geometry.location.lat;
data3[counter3].lng=results[0].geometry.location.lng;
counter3++;
p12++;	
console.log("yess this is found!! hi bhabhi!"+data3[counter]);

   } else {
console.log("error");

    }


  });

}


    </script>
    

  </head>

  <body>
    <div id="panel">
      <button onclick="toggleHeatmap()">Toggle Heatmap</button>
      <button onclick="changeGradient()">Change gradient</button>
      <button onclick="changeRadius()">Change radius</button>
      <button onclick="changeOpacity()">Change opacity</button>
    </div>
    <div id="map-canvas"></div>
  </body>
</html>
